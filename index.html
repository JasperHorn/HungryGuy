<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>A simple game in React</title>

    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>

    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  </head>

  <body>
    <div id="root"></div>
    <script type="text/babel">
        class HungerHUD extends React.Component {
            render() {
                return (
                    <p>Your hunger is at: { this.props.hunger }</p>
                );
            };
        }

        class FeedButtons extends React.Component {
            render() {
                return (
                    <button onClick={() => this.props.decreaseHunger(12)}>Eat a burger!</button>
                );
            };
        }

        class GamePage extends React.Component {
            constructor(props) {
                super(props);

                this.state = {
                    hunger: 30,
                    running: true
                };
            };

            render() {
                if (this.state.running) {
                    return (
                        <div>
                            <h1>Hello World!</h1>
                            <HungerHUD hunger={this.state.hunger} />
                            <FeedButtons decreaseHunger={ (n) => this.decreaseHunger(n) }/>
                        </div>
                    );
                }
                else {
                    return (
                        <div>
                            <h1>Hello World!</h1>
                            <p>Game over!</p>
                        </div>
                    );
                }
            };

            componentDidMount() {
                this.interval = setInterval(() => this.increaseHunger(), 5000);
            };

            componentWillUnmount() {
                clearInterval(this.interval);
            };

            increaseHunger() {
                this.setState(state => ({
                    hunger: state.hunger + 10,
                    running: state.hunger + 10 <= 100
                }));
            };

            decreaseHunger(amount) {
                this.setState(state => {
                    let hunger = state.hunger - amount;

                    if (hunger < 0) {
                        hunger = 0;
                    }

                    return {
                        hunger: hunger,
                        running: state.running
                    };
                });
            }
        }

        ReactDOM.render(
            <GamePage />,
            document.getElementById('root')
        );
    </script>
  </body>
</html>
